<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Driver Retro — Pixel (corrigido)</title>
  <style>
    :root{
      --bg:#f7931e;
      --road:#333;
      --car:#ff0000;
      --enemy:#0000ff;
      --audience:#ffd700;
    }
    body{
      margin:0;
      background:var(--bg);
      font-family:sans-serif;
      overflow:hidden;
    }
    canvas{
      display:block;
      margin:auto;
      background:var(--road);
    }

    /* ===== Estilo do popup ===== */
    #popupForm {
      display:none; 
      position:fixed; 
      top:0; left:0; 
      width:100%; height:100%; 
      background:rgba(0,0,0,0.7); 
      z-index:9999; 
      display:flex; 
      align-items:center; 
      justify-content:center;
    }
    #popupForm .content {
      background:#fff; 
      padding:30px; 
      border-radius:10px; 
      text-align:center; 
      max-width:400px; 
      width:90%;
    }
    #popupForm input {
      width:100%; 
      padding:10px; 
      margin:10px 0; 
      border:1px solid #ccc; 
      border-radius:5px;
    }
    #popupForm button {
      padding:12px 20px; 
      background:#25D366; 
      color:#fff; 
      border:none; 
      border-radius:8px; 
      cursor:pointer; 
      width:100%;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="400" height="600"></canvas>

  <!-- ===== Popup ===== -->
  <div id="popupForm">
    <div class="content">
      <h2>Um instante por favor...</h2>
      <p>Para prosseguirmos, digite seus dados abaixo:</p>
      
      <input type="text" id="nome" placeholder="Digite seu nome">
      <input type="text" id="telefone" placeholder="Digite seu telefone">
      
      <button onclick="enviarWhatsApp()">Enviar</button>
    </div>
  </div>

  <script>
    // === Jogo (continua igual ao seu) ===
    const canvas=document.getElementById("gameCanvas");
    const ctx=canvas.getContext("2d");

    let car={x:180,y:500,w:40,h:80,color:"red"};
    let enemies=[];
    let keys={};

    document.addEventListener("keydown",e=>keys[e.key]=true);
    document.addEventListener("keyup",e=>keys[e.key]=false);

    function drawCar(c){
      ctx.fillStyle=c.color;
      ctx.fillRect(c.x,c.y,c.w,c.h);
    }

    function spawnEnemy(){
      let x=Math.random()* (canvas.width-40);
      enemies.push({x:x,y:-80,w:40,h:80,color:"blue"});
    }

    function update(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      if(keys["ArrowLeft"]&&car.x>0) car.x-=5;
      if(keys["ArrowRight"]&&car.x<canvas.width-car.w) car.x+=5;

      drawCar(car);

      enemies.forEach(e=>{
        e.y+=3;
        drawCar(e);
      });

      enemies=enemies.filter(e=>e.y<canvas.height);

      requestAnimationFrame(update);
    }
    setInterval(spawnEnemy,1500);
    update();

    // === Popup com localStorage ===
    window.onload = () => {
      const jaEnviou = localStorage.getItem("popupEnviado");
      if(!jaEnviou){
        setTimeout(() => {
          document.getElementById("popupForm").style.display = "flex";
        }, 10000);
      }
    }

    function enviarWhatsApp(){
      const nome = document.getElementById("nome").value.trim();
      const telefone = document.getElementById("telefone").value.trim();
      
      if(nome === "" || telefone === ""){
        alert("Por favor, preencha todos os campos!");
        return;
      }

      const numeroDestino = "5511984872151"; // seu número com DDI
      const mensagem = `Nome: ${nome}%0ATelefone: ${telefone}`;
      const url = `https://wa.me/${numeroDestino}?text=${mensagem}`;
      
      window.open(url, "_blank"); // abre WhatsApp
      document.getElementById("popupForm").style.display = "none"; // fecha popup
      localStorage.setItem("popupEnviado", "true"); // salva que já enviou
    }
  </script>
</body>
</html>
